<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.gt.game.core.dao.common.FansInfoMapper">
    <resultMap id="MoreResultMap" type="com.gt.game.core.bean.common.res.MemberListPageRes">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. This element was generated on Mon Jul 20
            14:13:31 CST 2015. -->
        <id column="id" property="id" jdbcType="INTEGER" />
        <result column="openid" property="openid" jdbcType="VARCHAR" />
        <result column="nickname" property="nickname" typeHandler="com.gt.game.core.bean.common.res.ConvertBlobTypeHandler" />
        <result column="sex" property="sex" jdbcType="INTEGER" />
        <result column="headimgurl" property="headimgurl" jdbcType="VARCHAR" />
        <result column="city" property="city" jdbcType="VARCHAR" />
        <result column="jointime" javaType="java.util.Date" property="jointime" jdbcType="TIMESTAMP" />
        <result column="name" property="name" jdbcType="CHAR" />
    </resultMap>
    <select id="getMemberList" resultMap="MoreResultMap"
            parameterType="Map">
        select
        t.id,t.openid,t.nickname,t.sex,t.city,t.jointime,t.headimgurl,w.name
        from t_fans_info t  , t_wx_groups w
        where t.wx_user_id =
        #{wxUserId,jdbcType=VARCHAR} and
        t.STATUS=1 and (t.`wx_user_id`=w.`wx_user_id` AND t.`GROUPID`=w.`gid` )
        <if test="search!=null and search!=''">
            and t.nickname like #{search,jdbcType=BLOB} or t.remark like #{search,jdbcType=VARCHAR}
        </if>
        ORDER BY t.JOINTIME desc
    </select>

</mapper>
webpackJsonp([86],{TV8S:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__api_api__=__webpack_require__("TSM+");__webpack_exports__.a={data:function(){var e=this,r=function(e,r,t){r?r<0?t(new Error("请输入大于0的整数")):t():t(new Error("每天抽奖次数不能为空"))};return{active:0,pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},ruleForm1:{type:1,luckName:"",acttime:[],luckLuckPartaker:1,luckBeforeTxt:"",luckDescribe:"",music:"暂无上传音乐",musicUrl:"",luckPway:1,name1:"",name2:"",name3:"",name4:""},rules1:{luckName:[{required:!0,message:"活动名称不能为空",trigger:"blur"}],luckBeforeTxt:[{required:!0,message:"活动说明不能为空",trigger:"blur"}],luckDescribe:[{required:!0,message:"活动未开始提示不能为空",trigger:"blur"}],luckLuckPartaker:[{required:!0}],acttime:[{required:!0,type:"array",message:"开始时间不能为空",trigger:"blur"}],luckPway:[{validator:function(r,t,l){2==e.ruleForm1.luckPway&&""==e.ruleForm1.name1?l(new Error("不能为空")):2==e.ruleForm1.luckPway&&e.ruleForm1.name1<0?l(new Error("请输入大于0的整数")):3==e.ruleForm1.luckPway&&""==e.ruleForm1.name2?l(new Error("不能为空")):3==e.ruleForm1.luckPway&&e.ruleForm1.name2<0?l(new Error("请输入大于0的整数")):4==e.ruleForm1.luckPway&&""==e.ruleForm1.name3||4==e.ruleForm1.luckPway&&""==e.ruleForm1.name4?l(new Error("不能为空")):4==e.ruleForm1.luckPway&&e.ruleForm1.name3<0?l(new Error("请输入大于0的整数")):4==e.ruleForm1.luckPway&&e.ruleForm1.name4<0?l(new Error("请输入大于0的整数")):l()},trigger:"blur"}]},ruleForm2:{luckCountOfDay:"",luckCountOfAll:""},rules2:{luckCountOfDay:[{required:!0,validator:r,trigger:"blur"}],luckCountOfAll:[{required:!0,validator:r,trigger:"blur"}]},ruleForm3:{luckCashDay:"",luckAddress:""},rules3:{luckCashDay:[{required:!0,message:"兑奖期限不能为空",trigger:"blur"}],luckAddress:[{required:!0,message:"兑奖地址不能为空",trigger:"blur"}]},ruleForm4:[{name0:"",name1:"",name2:"",name3:"",name4:"",nickname:"",openid:""}],dialogFans:!1,key:0,isSubmit:!1}},methods:{shoeDialogFans:function(e){this.key=e,this.dialogFans=!0,console.log(this.key)},getFansData:function(e){console.log(e,"子组件的信息"),this.dialogFans=!1;for(var r=this.key,t=[],l=[],a=0;a<e.length;a++){var s={nickname:e[a].nickname,openid:e[a].openid};t.push(s.nickname),l.push(s.openid)}this.ruleForm4[r].nickname=t+"",this.ruleForm4[r].openid=l+""},submit:function(){var e=this,r="",t="";2==this.ruleForm1.luckPway?r=this.ruleForm1.name1:3==this.ruleForm1.luckPway?t=this.ruleForm1.name2:4==this.ruleForm1.luckPway&&(r=this.ruleForm1.name3,t=this.ruleForm1.name4);for(var l=[],a=0;a<this.ruleForm4.length;a++){var s={luckPrizeType:this.ruleForm4[a].name0,luckPrizeLimit:Number(this.ruleForm4[a].name1),luckPrizeName:this.ruleForm4[a].name2,luckPrizeNums:Number(this.ruleForm4[a].name3),luckPrizeChance:Number(this.ruleForm4[a].name4),nickname:this.ruleForm4[a].nickname,openid:this.ruleForm4[a].openid};l.push(s)}console.log(l,123);var o={id:this.$router.history.current.query.id,luckName:this.ruleForm1.luckName,luckBeginTime:this.ruleForm1.acttime[0],luckEndTime:this.ruleForm1.acttime[1],luckBgm:this.ruleForm1.musicUrl,luckBgmName:this.ruleForm1.music,luckBeforeTxt:this.ruleForm1.luckBeforeTxt,luckDescribe:this.ruleForm1.luckDescribe,luckLuckPartaker:this.ruleForm1.luckLuckPartaker,luckPway:this.ruleForm1.luckPway,luckKou:t,luckMan:r,luckCountOfDay:this.ruleForm2.luckCountOfDay,luckCountOfAll:this.ruleForm2.luckCountOfAll,luckCashDay:Number(this.ruleForm3.luckCashDay),luckAddress:this.ruleForm3.luckAddress,luckDetailReqs:l};console.log(o,123),Object(__WEBPACK_IMPORTED_MODULE_0__api_api__.j)(o).then(function(r){100==r.code?e.$message({message:"操作成功",type:"success"}):e.$message.error(r.msg)}).catch(function(){e.$message({type:"info",message:"网络问题，请刷新重试~"})})},test:function(){console.log(123)},getMusic:function(e){console.log(e),this.ruleForm1.music=e.music.name,this.ruleForm1.musicUrl=e.music.url},delForm4:function(e){this.ruleForm4.splice(e,1)},addForm4:function(){this.ruleForm4.push({name0:"",name1:"",name2:"",name3:"",name4:"",nickname:"",openid:""})},next:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;r.submit()})},lastStep:function(){for(var e=0;e<this.ruleForm4.length;e++){var r=/^[1-9]\d*$/;if(!(this.ruleForm4[e].name1&&this.ruleForm4[e].name2&&this.ruleForm4[e].name3&&this.ruleForm4[e].name4))return this.$message.error("表单不能留空，请填写完整~"),!1;if(!r.test(this.ruleForm4[e].name1))return this.$message.error("奖品数额填写有误，请重新填写~"),!1;if(!r.test(this.ruleForm4[e].name3))return this.$message.error("奖项数量填写有误，请重新填写~"),!1}this.checkGL()},checkGL:function checkGL(){for(var arr1=[],i=0;i<this.ruleForm4.length;i++){var arr2={id:parseFloat(this.ruleForm4[i].name4).toFixed(2)};arr1.push(arr2.id)}var getSum=function getSum(ar){var arr=ar,s=eval(arr.join("+"));return s},sum=getSum(arr1);100!=sum?this.$message.error("中奖概率之和必须等于100%"):this.submit()},backUrl:function(){window.history.go(-1)},geteditData:function(){var e=this,r=this.$router.history.current.query.id;Object(__WEBPACK_IMPORTED_MODULE_0__api_api__.b)({id:r}).then(function(r){if(100==r.code){console.log(r,1233),e.ruleForm1=r.data,e.ruleForm1.acttime=[r.data.luckBeginTime,r.data.luckEndTime],e.ruleForm1.musicUrl=r.data.luckBgm,e.ruleForm1.music=r.data.luckBgmName,e.ruleForm1.luckPway=Number(r.data.luckPway),2==e.ruleForm1.luckPway?e.ruleForm1.name1=r.data.luckMan:3==e.ruleForm1.luckPway?e.ruleForm1.name2=r.data.luckKou:4==e.ruleForm1.luckPway&&(e.ruleForm1.name3=r.data.luckMan,e.ruleForm1.name4=r.data.luckKou),e.ruleForm2=r.data,e.ruleForm3=r.data;for(var t=[],l=0;l<r.data.luckDetailReqs.length;l++){var a={name0:r.data.luckDetailReqs[l].luckPrizeType,name1:r.data.luckDetailReqs[l].luckPrizeLimit,name2:r.data.luckDetailReqs[l].luckPrizeName,name3:String(r.data.luckDetailReqs[l].luckPrizeNums),name4:String(r.data.luckDetailReqs[l].luckPrizeChance),nickname:String(r.data.luckDetailReqs[l].nickname),openid:String(r.data.luckDetailReqs[l].openid)};t.push(a)}e.ruleForm4=t}else e.$message.error(r.msg)}).catch(function(){e.$message({type:"info",message:"网络问题，请刷新重试~"})})},getPrizeTypeData:function(){var e=this;Object(__WEBPACK_IMPORTED_MODULE_0__api_api__.g)().then(function(r){100==r.code?(console.log(r,1233),e.options=r.data,console.log(e.options,444)):e.$message.error(r.msg)}).catch(function(){e.$message({type:"info",message:"网络问题，请刷新重试~"})})}},filters:{sexStatus:function(e){return 2==e?e="女":1==e?e="男":0==e&&(e="未知"),e},prizeStatus:function(e){return 0==e?e="一等奖":1==e?e="二等奖":2==e?e="三等奖":3==e?e="四等奖":4==e?e="五等奖":5==e&&(e="六等奖"),e}},mounted:function(){this.getPrizeTypeData(),this.geteditData()}}},q6An:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var l=t("TV8S"),a={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("section",[t("div",{staticClass:"hd-common turnPlate"},[t("el-breadcrumb",{staticClass:"gt-crumbs",attrs:{separator:"/"}},[t("el-breadcrumb-item",[e._v("互动游戏")]),e._v(" "),t("el-breadcrumb-item",{attrs:{to:{path:"/luckTranslate/index"}}},[e._v("好运翻翻看")]),e._v(" "),t("el-breadcrumb-item",[e._v("创建活动")])],1),e._v(" "),t("div",{staticClass:"gt-content"},[t("el-tabs",{attrs:{type:"card"},model:{value:e.active,callback:function(r){e.active=r},expression:"active"}},[t("el-tab-pane",{attrs:{label:"基础设置",name:"0"}}),e._v(" "),t("el-tab-pane",{attrs:{label:"规则设置",name:"1"}}),e._v(" "),t("el-tab-pane",{attrs:{label:"兑奖设置",name:"2"}}),e._v(" "),t("el-tab-pane",{attrs:{label:"奖项设置",name:"3"}})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:0==this.active,expression:"this.active==0"}],staticClass:"mt40"},[t("el-form",{ref:"ruleForm1",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm1,rules:e.rules1,"label-width":"160px"}},[t("el-form-item",{attrs:{label:"活动名称：",prop:"luckName"}},[t("el-input",{staticClass:"w_demo",attrs:{maxlength:20,placeholder:"请输入活动名称"},model:{value:e.ruleForm1.luckName,callback:function(r){e.$set(e.ruleForm1,"luckName",r)},expression:"ruleForm1.luckName"}}),e._v(" "),t("span",{staticClass:"el-upload__tip grey"},[e._v("\r\n                       20个字数以内\r\n                    ")])],1),e._v(" "),t("el-form-item",{attrs:{label:"游戏时间：",prop:"acttime"}},[t("el-date-picker",{staticClass:"w_demo",attrs:{"picker-options":e.pickerOptions,type:"datetimerange",placeholder:"选择时间范围"},model:{value:e.ruleForm1.acttime,callback:function(r){e.$set(e.ruleForm1,"acttime",r)},expression:"ruleForm1.acttime"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"活动说明：",prop:"luckBeforeTxt"}},[t("el-input",{staticClass:"w_demo",attrs:{type:"textarea",rows:3,placeholder:"请输入活动说明"},model:{value:e.ruleForm1.luckBeforeTxt,callback:function(r){e.$set(e.ruleForm1,"luckBeforeTxt",r)},expression:"ruleForm1.luckBeforeTxt"}}),e._v(" "),t("span",{staticClass:"el-upload__tip grey"},[e._v("\r\n                        描述活动详情，能让粉丝了解此次活动\r\n                    ")])],1),e._v(" "),t("el-form-item",{attrs:{label:"活动未开始提示：",prop:"luckDescribe"}},[t("el-input",{staticClass:"w_demo",attrs:{type:"textarea",rows:3,placeholder:"如：活动尚未开始，敬请期待!"},model:{value:e.ruleForm1.luckDescribe,callback:function(r){e.$set(e.ruleForm1,"luckDescribe",r)},expression:"ruleForm1.luckDescribe"}}),e._v(" "),t("span",{staticClass:"el-upload__tip grey"},[e._v("\r\n                        活动未开始提示限制在100个字数以内\r\n                    ")])],1),e._v(" "),t("el-form-item",{attrs:{label:"参与人员：",prop:"luckLuckPartaker"}},[t("el-radio-group",{model:{value:e.ruleForm1.luckLuckPartaker,callback:function(r){e.$set(e.ruleForm1,"luckLuckPartaker",r)},expression:"ruleForm1.luckLuckPartaker"}},[t("el-radio",{attrs:{label:1}},[e._v("所有粉丝")]),e._v(" "),t("el-radio",{attrs:{label:2}},[e._v("仅会员\r\n                        "),t("span",{staticClass:"el-upload__tip grey"},[e._v("\r\n                        (持有会员卡的粉丝)\r\n                        ")])])],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:2==e.ruleForm1.luckLuckPartaker,expression:"ruleForm1.luckLuckPartaker==2"}],staticClass:"pd20 bw pt10 bb ml150 mb20"},[t("el-form-item",{attrs:{label:"参与方式：","label-width":"100px",prop:"luckPway"}},[t("el-radio-group",{model:{value:e.ruleForm1.luckPway,callback:function(r){e.$set(e.ruleForm1,"luckPway",r)},expression:"ruleForm1.luckPway"}},[t("el-radio",{attrs:{label:1}},[e._v("所有会员不需要积分")]),t("br"),t("br"),e._v(" "),t("el-radio",{attrs:{label:2}},[e._v("会员卡积分满"),t("el-input",{staticClass:"w100_demo ml10 mt20 mr10",attrs:{disabled:"2"!=e.ruleForm1.luckPway},model:{value:e.ruleForm1.name1,callback:function(r){e.$set(e.ruleForm1,"name1",r)},expression:"ruleForm1.name1"}}),e._v("即可参加（抽奖不扣除积分）")],1),t("br"),t("br"),e._v(" "),t("el-radio",{attrs:{label:3}},[e._v("每次抽奖扣除"),t("el-input",{staticClass:"w100_demo ml10 mt20 mr10",attrs:{disabled:"3"!=e.ruleForm1.luckPway},model:{value:e.ruleForm1.name2,callback:function(r){e.$set(e.ruleForm1,"name2",r)},expression:"ruleForm1.name2"}}),e._v("积分")],1),t("br"),t("br"),e._v(" "),t("el-radio",{attrs:{label:4}},[e._v("会员卡积分满"),t("el-input",{staticClass:"w100_demo ml10 mt20 mr10",attrs:{disabled:"4"!=e.ruleForm1.luckPway},model:{value:e.ruleForm1.name3,callback:function(r){e.$set(e.ruleForm1,"name3",r)},expression:"ruleForm1.name3"}}),e._v("分，\r\n                                                 每次抽奖扣除"),t("el-input",{staticClass:"w100_demo ml10 mt20 mr10",attrs:{disabled:"4"!=e.ruleForm1.luckPway},model:{value:e.ruleForm1.name4,callback:function(r){e.$set(e.ruleForm1,"name4",r)},expression:"ruleForm1.name4"}}),e._v("分")],1)],1)],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"背景音乐："}},[t("div",{staticClass:"pd20 bb bw bgMusic"},[t("gt-material",{attrs:{prop:"",isMusic:!0,index:2,btnContent:"点击上传",width:"72",height:"72"},on:{getChangeUrl:e.getMusic}}),e._v(" "),t("span",{staticClass:"el-upload__tip grey ml20"},[e._v(e._s(e.ruleForm1.music))]),e._v(" "),t("div",{staticClass:"el-upload__tip grey",staticStyle:{"line-height":"25px"}},[e._v("\r\n                            音频文件的格式为mp3、wma、wav,大小不超过3M\r\n                        ")])],1)])],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:1==this.active,expression:"this.active==1"}],staticClass:"mt40"},[t("el-form",{ref:"ruleForm2",staticClass:"mt40 demo-ruleForm",attrs:{model:e.ruleForm2,rules:e.rules2,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"游戏总数：",prop:"luckCountOfDay"}},[t("el-input",{staticClass:"w_demo mr10",attrs:{type:"number",placeholder:"请输入每人抽奖总次数"},model:{value:e.ruleForm2.luckCountOfDay,callback:function(r){e.$set(e.ruleForm2,"luckCountOfDay",r)},expression:"ruleForm2.luckCountOfDay"}}),e._v(" 次/人\r\n                    ")],1),e._v(" "),t("el-form-item",{attrs:{label:"每天次数：",prop:"luckCountOfAll"}},[t("el-input",{staticClass:"w_demo mr10",attrs:{type:"number",placeholder:"请输入每人/每天抽奖总数"},model:{value:e.ruleForm2.luckCountOfAll,callback:function(r){e.$set(e.ruleForm2,"luckCountOfAll",r)},expression:"ruleForm2.luckCountOfAll"}}),e._v("次/人\r\n                    ")],1)],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:2==this.active,expression:"this.active==2"}],staticClass:"mt40"},[t("el-form",{ref:"ruleForm3",staticClass:"mt40 demo-ruleForm",attrs:{model:e.ruleForm3,rules:e.rules3,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"兑奖期限：",prop:"luckCashDay"}},[t("el-input",{staticClass:"w_demo mr10",attrs:{type:"number",placeholder:"请输入兑奖期限"},model:{value:e.ruleForm3.luckCashDay,callback:function(r){e.$set(e.ruleForm3,"luckCashDay",r)},expression:"ruleForm3.luckCashDay"}}),e._v("天\r\n                    "),t("span",{staticClass:"el-upload__tip grey"},[e._v("\r\n                        从活动结束后开始计算\r\n                    ")])],1),e._v(" "),t("el-form-item",{attrs:{label:"兑奖地址：",prop:"luckAddress"}},[t("el-input",{staticClass:"w_demo",attrs:{type:"textarea",rows:5,placeholder:"请输入兑奖地址"},model:{value:e.ruleForm3.luckAddress,callback:function(r){e.$set(e.ruleForm3,"luckAddress",r)},expression:"ruleForm3.luckAddress"}})],1)],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:3==this.active,expression:"this.active==3"}],staticClass:"mt40"},[e._m(0),e._v(" "),t("div",{staticClass:"mt20 mb20"},[t("el-button",{attrs:{disabled:e.ruleForm4.length>4,type:"primary"},on:{click:function(r){e.addForm4()}}},[e._v("新增奖品")]),e._v(" "),t("span",{staticClass:"el-upload__tip grey ml10"},[e._v("最多设置五个奖项")])],1),e._v(" "),t("el-table",{ref:"multipleTable",attrs:{data:e.ruleForm4,"tooltip-effect":"dark"}},[t("el-table-column",{attrs:{label:"奖品类型"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-select",{attrs:{placeholder:"请选择"},model:{value:r.row.name0,callback:function(t){e.$set(r.row,"name0",t)},expression:"scope.row.name0"}},[t("el-option",{attrs:{label:"粉币",value:1}}),e._v(" "),t("el-option",{attrs:{label:"手机流量",value:2}}),e._v(" "),t("el-option",{attrs:{label:"手机话费",value:3}}),e._v(" "),t("el-option",{attrs:{label:"实体物品",value:4}}),e._v(" "),t("el-option",{attrs:{label:"谢谢参与",value:5}}),e._v(" "),t("el-option",{attrs:{label:"积分",value:6}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"奖品数额"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-input",{staticClass:"w20_demo",attrs:{type:"number",placeholder:"数值应大于0"},model:{value:r.row.name1,callback:function(t){e.$set(r.row,"name1",t)},expression:"scope.row.name1"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"奖项名称"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-input",{staticClass:"w20_demo",attrs:{placeholder:"请输入奖项名称"},model:{value:r.row.name2,callback:function(t){e.$set(r.row,"name2",t)},expression:"scope.row.name2"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"奖项数量"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-input",{staticClass:"w20_demo",attrs:{type:"number",placeholder:"数值应大于0"},model:{value:r.row.name3,callback:function(t){e.$set(r.row,"name3",t)},expression:"scope.row.name3"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"中奖概率(%)"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-input",{staticClass:"w20_demo",attrs:{placeholder:"0-100且保留两位小数"},model:{value:r.row.name4,callback:function(t){e.$set(r.row,"name4",t)},expression:"scope.row.name4"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"中奖人"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v("\r\n                      "+e._s(r.row.nickname)+"\r\n                    ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{staticClass:"gt-button-normal blue",on:{click:function(t){e.shoeDialogFans(r.$index)}}},[e._v("指定中奖人")]),e._v(" "),0!=r.$index?t("el-button",{staticClass:"gt-button-normal",on:{click:function(t){e.delForm4(r.$index)}}},[e._v("删除")]):e._e()]}}])})],1)],1),e._v(" "),t("div",{staticClass:"h80"}),e._v(" "),t("div",{staticClass:"btnRow"},[t("el-button",{on:{click:function(r){e.backUrl()}}},[e._v("返回")]),e._v(" "),0==this.active?t("el-button",{attrs:{type:"primary"},on:{click:function(r){e.next("ruleForm1")}}},[e._v("保存")]):e._e(),e._v(" "),1==this.active?t("el-button",{attrs:{type:"primary"},on:{click:function(r){e.next("ruleForm2")}}},[e._v("保存")]):e._e(),e._v(" "),2==this.active?t("el-button",{attrs:{type:"primary"},on:{click:function(r){e.next("ruleForm3")}}},[e._v("保存")]):e._e(),e._v(" "),3==this.active?t("el-button",{attrs:{type:"primary"},on:{click:function(r){e.lastStep()}}},[e._v("保存")]):e._e()],1),e._v(" "),t("gt-Fans-detail",{attrs:{visible:e.dialogFans},on:{"update:visible":function(r){e.dialogFans=r},getFansData:e.getFansData}})],1)],1)])},staticRenderFns:[function(){var e=this.$createElement,r=this._self._c||e;return r("div",{staticClass:"gt-gray-region",staticStyle:{color:"#666","line-height":"20px"}},[r("p",[this._v("奖品数额：奖品的数量或内容；奖项数量：该奖品的可领取次数；中奖概率：每种奖项在转盘中的中奖概率")]),this._v(" "),r("p",[this._v("如：奖品类型：粉币；奖品数额：2；奖项名称：粉币；奖项数量：3；中奖概率：12")]),this._v(" "),r("p",[this._v("此次游戏活动设置了六个奖项：其中一个奖项为粉币(奖项名称)，该奖项出现3次(中奖数量)，中了该奖项会得到2个(奖品数额)粉币（奖品类型）。")]),this._v(" "),r("p",[this._v("当奖品为实物时，请上传实物图片，实物图片建议尺寸1160px*64px")])])}]},s=t("VU/8")(l.a,a,!1,null,null,null);r.default=s.exports}});